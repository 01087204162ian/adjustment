# 배민 정산 스크립트 요구사항 체크리스트

## 정산 기준
- [x] 배민 정산 기준시간: 06:00 ~ D+1 06:00 (문서화됨)
- [x] DB 정산 기준시간: 00:00 ~ 24:00 (문서화됨)
- [x] 경기도 일부 지역의 운행 중복시간 처리 (구현됨)

## 처리 순서

### 1. 운행시간(G열, H열)을 YYYY-MM-DD HH:MM:SS 형식으로 변경
- [x] 시작시간(G열) 형식 변환 (158-172줄)
- [x] 종료시간(H열) 형식 변환 (158-172줄)
- [x] 원본 컬럼 업데이트 (169-172줄)

### 2. 전체 운행시간(I열) = 종료시간(H열) - 시작시간(G열)
- [x] 종료시간에서 시작시간을 뺀 값으로 계산 (174-177줄)
- [x] 원본 컬럼 업데이트 (179-181줄)

### 3. 상태정보(M열)이 '00'이 아닌 경우 정산 제외 (I열 값 삭제)
- [x] 상태정보가 '00'인 경우만 정산 대상 (47줄)
- [x] '00'이 아닌 경우 전체 운행시간(I열) 값 삭제 (188-195줄)

### 4. 보험사 기준영업일(O열) = 시작시간(G열)의 YYYY-MM-DD
- [x] 시작시간의 YYYY-MM-DD 형식으로 계산 (197-203줄)
- [x] 원본 컬럼 업데이트 (205-207줄)

### 5. 보험사 기사아이디(E열)의 보험사 기준영업일(O열)별 전체 운행시간 합산
- [x] 기사아이디 + 기준영업일별 그룹화 (225줄)
- [x] 전체 운행시간 합산 (237줄)

### 6. 보험사 기사아이디 오름차순 정렬
- [x] 기사아이디 오름차순 정렬 (212-214줄)

### 7. 이전 종료시간(H열)이 바로 다음 시작시간(G열)보다 더 이후인 운행건 확인
- [x] 이전 종료시간과 다음 시작시간 비교 (216-219줄)
- [x] 중복 플래그 설정 (219줄)

### 8. 일별 중복 운행시간 산출
- [x] 구간 병합 함수 사용 (230줄)
- [x] 중복 운행시간 계산 (235-239줄)

### 9. 보험사 기사아이디(E열)의 보험사 기준영업일(O열)별 전체 운행시간에서 중복 운행시간 차감
- [x] 총 운행시간에서 중복 시간 차감 (237-239줄)
- [x] 정산운행시간 계산 (247줄)

### 10. 운행시간(분)에 따른 보험료 산출
- [x] 담보별 요율 적용 (대인1지원: 3.28, 대인2: 4.34, 대물: 3.68) (40-44줄)
- [x] 원단위 절사 (297줄)
- [x] 담보별 보험료 계산 후 합산 (291-304줄)

### 11. 보험사기준 영업일(O열)별 운행시간(분)과 보험료를 표로 산출
- [x] 일자요약 시트 생성 (321줄)
- [x] 운행시간과 보험료 표시 (241-249줄, 311줄)

## 담보별 요율
- [x] 대인1지원: 3.28 (41줄)
- [x] 대인2: 4.34 (42줄)
- [x] 대물: 3.68 (43줄)

## 출력 시트
- [x] 01_상세_보험료 (319줄)
- [x] 02_일자요약_보험료 (321줄)
- [x] 03_병합구간(검증) (323줄)

## 주의사항
- 보험료 계산 시 중복 차감 전의 시간을 사용하고 있음 (295줄)
  - 요구사항 10번에서 "총 분단위 시간"이라고 명시되어 있어 현재 구현이 맞을 수 있음
  - 하지만 주석(287줄)에는 "정산운행시간(중복차감 후)"라고 되어 있어 확인 필요

